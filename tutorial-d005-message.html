<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Tutorial: 消息 | Gtedx IM SDK</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-jsdoc.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/tui-doc.css">

    
</head>
<body>
<nav class="lnb" id="lnb">
    <div class="logo" style="">
        
            <img src="img/toast-ui.png" width="100%" height="100%">
        
    </div>
    <div class="title">
        <h1><a href="index.html" class="link">Gtedx IM SDK</a></h1>
        
            <span class="version">v1.0.0</span>
        
    </div>
    <div class="search-container" id="search-container">
        <input type="text" placeholder="Search">
        <ul></ul>
    </div>
    
        <ol class="lnb-tab">
            <li id="api-tab">
                <a href="#"><h4>API</h4></a>
            </li>
            <li id="examples-tab">
                <a href="#"><h4>Examples</h4></a>
            </li>
        </ol>
    
    <div class="lnb-examples hidden"><h3>Examples</h3><ul><li><a href="tutorial-d001-introduction.html">简介</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="d001-introduction_sub"></div></li><li><a href="tutorial-d002-install-init.html">安装和初始化</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="d002-install-init_sub"></div></li><li><a href="tutorial-d003-single-chat.html">单聊</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="d003-single-chat_sub"></div></li><li><a href="tutorial-d004-group-chat.html">群聊</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="d004-group-chat_sub"></div></li><li><a href="tutorial-d005-message.html">消息</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="d005-message_sub"></div></li><li><a href="tutorial-d006-conversation.html">会话</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="d006-conversation_sub"></div></li><li><a href="tutorial-d007-cache.html">缓存</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="d007-cache_sub"></div></li><li><a href="tutorial-d008-client-event.html">事件</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="d008-client-event_sub"></div></li><li><a href="tutorial-d009-signin.html">登录</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="d009-signin_sub"></div></li><li><a href="tutorial-d010-signout.html">登出</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="d010-signout_sub"></div></li><li><a href="tutorial-d021-note.html">注意事项</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="d021-note_sub"></div></li><li><a href="tutorial-d022-update.html">方法更新</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="d022-update_sub"></div></li></ul></div><div class="lnb-api hidden"><h3>Modules</h3><ul><li><a href="module-Overview.html">Overview</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:Overview_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="module-Overview.html#.Cache">Cache</a></li><li><a href="module-Overview.html#.Cb">Cb</a></li><li><a href="module-Overview.html#.Conversation">Conversation</a></li><li><a href="module-Overview.html#.ConversationField">ConversationField</a></li><li><a href="module-Overview.html#.ConversationType">ConversationType</a></li><li><a href="module-Overview.html#.Env">Env</a></li><li><a href="module-Overview.html#.Event">Event</a></li><li><a href="module-Overview.html#.ImageMessage">ImageMessage</a></li><li><a href="module-Overview.html#.ImConfig">ImConfig</a></li><li><a href="module-Overview.html#.ImService">ImService</a></li><li><a href="module-Overview.html#.Log">Log</a></li><li><a href="module-Overview.html#.Message">Message</a></li><li><a href="module-Overview.html#.MessageField">MessageField</a></li><li><a href="module-Overview.html#.Platform">Platform</a></li><li><a href="module-Overview.html#.TextMessage">TextMessage</a></li><li><a href="module-Overview.html#.TypedMessage">TypedMessage</a></li></ul></div></li></ul></div><div class="lnb-api hidden"><h3>Classes</h3><ul><li><a href="Cache.html">Cache</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Cache_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="Cache.html#cacheConversation">cacheConversation</a></li><li><a href="Cache.html#cacheConversations">cacheConversations</a></li><li><a href="Cache.html#cacheMessage">cacheMessage</a></li><li><a href="Cache.html#cacheMessages">cacheMessages</a></li><li><a href="Cache.html#clearConversationMessages">clearConversationMessages</a></li><li><a href="Cache.html#clearMessages">clearMessages</a></li><li><a href="Cache.html#deleteConversation">deleteConversation</a></li><li><a href="Cache.html#getConversation">getConversation</a></li><li><a href="Cache.html#getConversations">getConversations</a></li><li><a href="Cache.html#getLastMessageByCid">getLastMessageByCid</a></li><li><a href="Cache.html#getMessages">getMessages</a></li><li><a href="Cache.html#getUnreadMsgCount">getUnreadMsgCount</a></li><li><a href="Cache.html#readMessageByCid">readMessageByCid</a></li></ul></div></li><li><a href="Cb.html">Cb</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Cb_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="Cb.html#.CodeNo">CodeNo</a></li><li><a href="Cb.html#.CodeOk">CodeOk</a></li><li><a href="Cb.html#.No">No</a></li><li><a href="Cb.html#.Ok">Ok</a></li><li><a href="Cb.html#code">code</a></li><li><a href="Cb.html#data">data</a></li><li><a href="Cb.html#message">message</a></li></ul></div></li><li><a href="Conversation.html">Conversation</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Conversation_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="Conversation.html#add">add</a></li><li><a href="Conversation.html#clearMessages">clearMessages</a></li><li><a href="Conversation.html#count">count</a></li><li><a href="Conversation.html#getLastMessage">getLastMessage</a></li><li><a href="Conversation.html#getMessages">getMessages</a></li><li><a href="Conversation.html#join">join</a></li><li><a href="Conversation.html#quit">quit</a></li><li><a href="Conversation.html#read">read</a></li><li><a href="Conversation.html#remove">remove</a></li><li><a href="Conversation.html#save">save</a></li><li><a href="Conversation.html#send">send</a></li></ul></div></li><li><a href="ConversationField.html">ConversationField</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="ConversationField_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="ConversationField.html#.Attrs">Attrs</a></li><li><a href="ConversationField.html#.ConversationId">ConversationId</a></li><li><a href="ConversationField.html#.Icon">Icon</a></li><li><a href="ConversationField.html#.ManagerId">ManagerId</a></li><li><a href="ConversationField.html#.MemberIds">MemberIds</a></li><li><a href="ConversationField.html#.Remark">Remark</a></li><li><a href="ConversationField.html#.Title">Title</a></li><li><a href="ConversationField.html#.Type">Type</a></li><li><a href="ConversationField.html#.UnreadCount">UnreadCount</a></li></ul></div></li><li><a href="ConversationType.html">ConversationType</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="ConversationType_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="ConversationType.html#.Group">Group</a></li><li><a href="ConversationType.html#.Single">Single</a></li></ul></div></li><li><a href="Env.html">Env</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Env_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="Env.html#.Dev">Dev</a></li><li><a href="Env.html#.Prd">Prd</a></li><li><a href="Env.html#.Test">Test</a></li></ul></div></li><li><a href="FileMessage.html">FileMessage</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="FileMessage_sub"></div></li><li><a href="ImageMessage.html">ImageMessage</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="ImageMessage_sub"></div></li><li><a href="ImClient.html">ImClient</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="ImClient_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="ImClient.html#currentConversationList">currentConversationList</a></li><li><a href="ImClient.html#currentConversationList">currentConversationList</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="ImClient.html#clearMessages">clearMessages</a></li><li><a href="ImClient.html#close">close</a></li><li><a href="ImClient.html#createConversation">createConversation</a></li><li><a href="ImClient.html#disbandConversation">disbandConversation</a></li><li><a href="ImClient.html#getConversation">getConversation</a></li><li><a href="ImClient.html#getConversations">getConversations</a></li><li><a href="ImClient.html#getUnreadMsgCount">getUnreadMsgCount</a></li><li><a href="ImClient.html#refreshConversations">refreshConversations</a></li><li><a href="ImClient.html#setCache">setCache</a></li></ul></div></li><li><a href="ImConfig.html">ImConfig</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="ImConfig_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="ImConfig.html#env">env</a></li><li><a href="ImConfig.html#platform">platform</a></li><li><a href="ImConfig.html#uid">uid</a></li></ul></div></li><li><a href="ImEvent.html">ImEvent</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="ImEvent_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="ImEvent.html#ConversationClearMessages">ConversationClearMessages</a></li><li><a href="ImEvent.html#Conversations">Conversations</a></li><li><a href="ImEvent.html#End">End</a></li><li><a href="ImEvent.html#Error">Error</a></li><li><a href="ImEvent.html#Message">Message</a></li><li><a href="ImEvent.html#UnreadMessagesCountUpdate">UnreadMessagesCountUpdate</a></li></ul></div></li><li><a href="ImService.html">ImService</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="ImService_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="ImService.html#options">options</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="ImService.html#createImClient">createImClient</a></li></ul></div></li><li><a href="ImType.html">ImType</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="ImType_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="ImType.html#.ErrorMsg">ErrorMsg</a></li><li><a href="ImType.html#.OffLine">OffLine</a></li><li><a href="ImType.html#.OnLine">OnLine</a></li><li><a href="ImType.html#.Received">Received</a></li><li><a href="ImType.html#.UserOnline">UserOnline</a></li></ul></div></li><li><a href="Message.html">Message</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Message_sub"></div></li><li><a href="MessageField.html">MessageField</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="MessageField_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="MessageField.html#.Attrs">Attrs</a></li><li><a href="MessageField.html#.ConversationID">ConversationID</a></li><li><a href="MessageField.html#.File">File</a></li><li><a href="MessageField.html#.Io">Io</a></li><li><a href="MessageField.html#.IsRead">IsRead</a></li><li><a href="MessageField.html#.Message">Message</a></li><li><a href="MessageField.html#.MessageID">MessageID</a></li><li><a href="MessageField.html#.MessageType">MessageType</a></li><li><a href="MessageField.html#.SendBy">SendBy</a></li><li><a href="MessageField.html#.SendTime">SendTime</a></li></ul></div></li><li><a href="MessageType.html">MessageType</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="MessageType_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="MessageType.html#.Image">Image</a></li><li><a href="MessageType.html#.Text">Text</a></li></ul></div></li><li><a href="Platform.html">Platform</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Platform_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="Platform.html#.App">App</a></li><li><a href="Platform.html#.Web">Web</a></li></ul></div></li><li><a href="TextMessage.html">TextMessage</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="TextMessage_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="TextMessage.html#attributes">attributes</a></li><li><a href="TextMessage.html#text">text</a></li><li><a href="TextMessage.html#type">type</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="TextMessage.html#getAttributes">getAttributes</a></li><li><a href="TextMessage.html#getText">getText</a></li><li><a href="TextMessage.html#setAttributes">setAttributes</a></li><li><a href="TextMessage.html#setText">setText</a></li></ul></div></li><li><a href="TypedMessage.html">TypedMessage</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="TypedMessage_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="TypedMessage.html#attributes">attributes</a></li><li><a href="TypedMessage.html#text">text</a></li><li><a href="TypedMessage.html#type">type</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="TypedMessage.html#getAttributes">getAttributes</a></li><li><a href="TypedMessage.html#getText">getText</a></li><li><a href="TypedMessage.html#setAttributes">setAttributes</a></li><li><a href="TypedMessage.html#setText">setText</a></li></ul></div></li></ul></div><div class="lnb-api hidden"><h3>Global</h3><ul><li><a href="global.html#createMessage">createMessage</a></li></ul></div>
</nav>
<div id="resizer"></div>

<div class="main" id="main">
    

<section>
    <header>
        

        <h2>消息</h2>
    </header>

    
        <article class="readme">
            <p>消息是一个对话的基本组成部分，我们支持的消息类型有：</p>
<ul>
<li>文本消息：<code>TextMessage</code></li>
<li>图像消息：<code>ImageMessage</code> 【待实现】</li>
<li>音频消息：<code>AudioMessage</code> 【待实现】</li>
<li>视频消息：<code>VideoMessage</code> 【待实现】</li>
<li>文件消息：<code>FileMessage</code> 【待实现】</li>
<li>位置消息：<code>LocationMessage</code> 【待实现】</li>
</ul>
<h2>消息类详解</h2><h4>消息类型之间的关系</h4><p><img src="https://raw.githubusercontent.com/im-gtedx/Image/master/message_arch.png" alt="消息类结构图"></p>
<h4>消息类均包含以下属性</h4><blockquote>
<p><a href="MessageField.html">MessageField</a> 类是SDK提供的消息类<a href="Message.html">Message</a>的属性枚举类。具体包括以下属性：</p>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align:left">属性</th>
<th style="text-align:left">类型</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">message_id</td>
<td style="text-align:left">string</td>
<td style="text-align:left">消息ID</td>
</tr>
<tr>
<td style="text-align:left">message_type</td>
<td style="text-align:left">string</td>
<td style="text-align:left">消息类型, 具体参见【<a href="MessageType.html">MessageType</a>】</td>
</tr>
<tr>
<td style="text-align:left">message</td>
<td style="text-align:left">string</td>
<td style="text-align:left">文本消息或图片消息的描述</td>
</tr>
<tr>
<td style="text-align:left">conversation_id</td>
<td style="text-align:left">string</td>
<td style="text-align:left">消息所属的会话ID</td>
</tr>
<tr>
<td style="text-align:left">send_time</td>
<td style="text-align:left">string</td>
<td style="text-align:left">消息发送时间</td>
</tr>
<tr>
<td style="text-align:left">send_by</td>
<td style="text-align:left">string</td>
<td style="text-align:left">消息发送者</td>
</tr>
<tr>
<td style="text-align:left">io</td>
<td style="text-align:left">string</td>
<td style="text-align:left">消息传输方向，有两种取值<code>true : send</code> 或 <code>false : received</code></td>
</tr>
<tr>
<td style="text-align:left">attrs</td>
<td style="text-align:left">string</td>
<td style="text-align:left">自定义属性, 具体参见下方《自定义消息属性》部分。</td>
</tr>
</tbody>
</table>
<blockquote>
<p>消息ID生成规则【<code>message_id</code> = uid + uuid】</p>
</blockquote>
<h2>自定义消息属性</h2><p>在某些场景下，开发者需要在发送消息时附带上自己业务逻辑需求的自定义属性，比如发送消息时携带设备名称，或发送消息携带自己的个人信息。开发者可以通过自定义消息属性实现这一需求。</p>
<p><strong>【场景一】发送文本消息给对方，让其知道我用的是什么手机跟他在聊天：</strong></p>
<pre class="prettyprint source lang-javascript"><code>let message = new TextMessage(&quot;静水流深&quot;);
message.setAttributes({
  phone: 'IPhone X',
});
conversation.send(message).then(function() {
  console.log('发送成功');
}).catch(console.error.bind(console));
</code></pre><p>接收时可以读取这一属性：</p>
<pre class="prettyprint source lang-javascript"><code>client.on('message', function(message) {
  console.log(message.getAttributes().phone); // IPhone X
});
</code></pre><p><strong>【场景二】在跟对方聊天的详情页，发送消息携带自己的个人信息，从而展示出头像和昵称。</strong></p>
<pre class="prettyprint source lang-javascript"><code>let message = new TextMessage(&quot;宁静致远&quot;);
// GLOBAL.User
const user = {
    id: &quot;9896d0783afa55ff194248ecc408baeb&quot;,
    name: &quot;Gtedx&quot;,
    avatar: &quot;https://avatar.jpg&quot;
}
message.setAttributes(user);

conversation.send(message).then(function() {
  console.log('发送成功');
}).catch(console.error.bind(console));
</code></pre><p>接收时可以读取这一属性：</p>
<pre class="prettyprint source lang-javascript"><code>client.on('message', function(message) {
  console.log(message.getAttributes()); 
  // {id: &quot;9896d0783afa55ff194248ecc408baeb&quot;,name: &quot;Gtedx&quot;,avatar: &quot;https://avatar.jpg&quot;}
});
</code></pre><blockquote>
<p>所有的 <code><a href="TypedMessage.html">TypedMessage</a></code> 消息都支持 <code>attrs</code> 这一属性。</p>
</blockquote>
<h2>消息的有效期</h2><p>一个会话的消息记录会在缓存本地，只要用户不清除缓存或清除当前会话的消息，会一直存在于本地。Gtedx IM 云端只负责转发消息。对于离线消息，云端会暂时缓存，等用户再次登录或建立连接，就会一次性推给客户端。</p>
<h4>清除所有的本地消息</h4><pre class="prettyprint source"><code>imClient.clearMessages()
    .then(() => {
        GLOBAL.Toast(&quot;消息已清空&quot;);
    })
    .catch(e => {
        GLOBAL.Toast(e.message);
    });</code></pre><h4>清除会话的本地消息</h4><pre class="prettyprint source"><code>conversation.clearMessages()
    .then(() => {
        GLOBAL.Toast(&quot;清空聊天记录成功&quot;);
     }).catch(e => {
        GLOBAL.Toast(e.message);
     });</code></pre><h2>消息发送选项【待实现】</h2><p>消息发送选项用于在发送消息时定义消息的一些特性。包含以下特性：</p>
<h4>成员提醒@</h4><h4>消息回执</h4><h5>送达回执</h5><h5>已读回执</h5><h2>未读消息</h2><p>未读消息数量通知功能是根据平台<a href="Platform.html">Platform</a>，在平台本地实现的。</p>
<p>SDK 会在 <a href="Conversation.html">Conversation</a> 上维护 <code><a href="ConversationField.html#.UnreadCount">ConversationField.UnreadCount</a></code> 字段，这个字段在变化时 <code>ImClient</code> 会派发 <code>ImEvent.Conversations</code> 事件。这个字段会在下面这些情况下发生变化：</p>
<ul>
<li>登录时，IM SDK 通知会话的未读消息数</li>
<li>收到在线消息</li>
<li>用户将对话标记为已读</li>
</ul>
<p>开发者应当监听 <code>ImEvent.Conversations</code> 事件，在对话列表界面上更新这些对话的未读消息数量。</p>
<blockquote>
<p>与会话的被动查询是同一个事件，</p>
</blockquote>
<h4>会话列表的未读消息更新</h4><pre class="prettyprint source lang-javascript"><code>imClient.on(ImEvent.Conversations, this._onConversation);

_onConversation = (conversations) => {
    if (conversations && conversations.length > 0) {
        // 会话列表
        let data = conversations.slice();
        this.setState({data});

        // 未读消息
        let unreadMessageCount = 0;
        data.forEach(cs => {
           unreadMessageCount += cs[ConversationField.UnreadCount];
        });
        this.setState({unreadMessageCount});
    } else {
        this.setState({data: [], unreadMessageCount: 0});
    }
}
</code></pre><h4>会话实例的未读消息更新</h4><pre class="prettyprint source lang-javascript"><code>/**直接在Item UI中获取Conversation的ConversationField.UnreadCount展示即可*/
render() { 
    let {conversation} = this.props;
    let title = conversation[ConversationField.Title];
    let avatar = conversation[ConversationField.Icon];
    let unread_count = conversation[ConversationField.UnreadCount];
    return &lt;View/>
}</code></pre><p>清除对话未读消息数的唯一方式是调用 <code><a href="Conversation.html#read">Conversation#read</a></code> 方法将对话标记为已读，一般来说开发者至少需要在下面两种情况下将对话标记为已读：</p>
<ul>
<li>在对话列表点击某对话进入到对话页面时</li>
<li>用户正在某个对话页面聊天，并在这个对话中收到了消息时</li>
</ul>
<pre class="prettyprint source lang-javascript"><code>// 进入到对话页面时标记其为已读
conversation.read().then(function(conversation) {
  console.log('对话已标记为已读');
}).catch(console.error.bind(console));

// 当前聊天的对话收到了消息立即标记为已读
currentConversation.on('message', function() {
  currentConversation.read().catch(console.error.bind(console));
})
</code></pre><blockquote>
<p>【待实现】后期根据业务可能会需要。</p>
<p>当用户标记某个对话为已读时，该用户其他在线的客户端也会得到通知，SDK 会自动将该对话的未读消息数更新为 0。</p>
</blockquote>
        </article>
    
</section>



</div>

<footer>
    <img class="logo" src="img/toast-ui.png" style="">
    <div class="footer-text">Copyright © 2018 Gtedx Pte Ltd</div>
</footer>
<script>prettyPrint();</script>
<script src="scripts/jquery.min.js"></script>
<script src="scripts/tui-doc.js"></script>
<script src="scripts/linenumber.js"></script>

    <script>
        showLnbExamples();
    </script>

</body>
</html>